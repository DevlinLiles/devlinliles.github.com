---
layout: post
title: Using Fluent Configuration with Entity Framework 4.1
date: 2011-05-24
---
<p>I have gotten the question several time over the last few weeks and usages for the fluent configuration of Code First POCO classes where the database does not match the convention. Here is a simple example on how to address this.</p>  <p>Take a product for example.</p>  <p>public class Product    <br />&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160; public int ID { get; set; }    <br />&#160;&#160;&#160;&#160;&#160;&#160; public string Name { get; set; }    <br />&#160;&#160;&#160;&#160;&#160;&#160; public string ProductNumber { get; set; }    <br />&#160;&#160;&#160;&#160;&#160;&#160; public bool MakeFlag { get; set; }    <br />&#160;&#160; }    <br /></p>  <p>To configure this to use different column names for the properties you simply need to add a configuration for that class like so.</p>  <p>public class ProductConfiguration :<font style="background-color: #ffff00"> EntityTypeConfiguration&lt;Product&gt;     <br /></font>&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160; public ProductConfiguration()    <br />&#160;&#160;&#160;&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this.ToTable(&quot;Product&quot;,&quot;Production&quot;);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this.HasKey(x =&gt; x.ID);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this.Property(x =&gt; x.ID).HasColumnName(&quot;ProductID&quot;);    <br />&#160;&#160;&#160;&#160;&#160;&#160; }    <br />&#160;&#160; }    <br /></p>  <p>Notice how the inheritance tells it which class it is setting up a type configuration for.</p>  <p>Then you load the configuration to the context in an override like so.</p>  <p>public class AdventureWorkContext : DbContext   <br />&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; public AdventureWorkContext(string adventureWorks)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : base(adventureWorks)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this.Database.CompatibleWithModel(false);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; protected override void OnModelCreating(DbModelBuilder modelBuilder)   <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font style="background-color: #ffff00">&#160; modelBuilder.Configurations.Add(new ProductConfiguration());     <br /></font>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; base.OnModelCreating(modelBuilder);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; public DbSet&lt;Product&gt; Products { get; set; }</p>  <p>}</p>
